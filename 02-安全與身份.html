<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS SAP 學習指南 - 安全與身份</title>
    <link rel=stylesheet type="text/css" href="common.css">
</head>
<body>
    <div class="nav">
        <a href="01-網絡架構.html">上一章：網絡架構</a>
        <a href="03-計算服務.html">下一章：計算服務</a>
    </div>

    <h1>安全與身份</h1>
    
    <div class="important">
        <p>安全與身份是 AWS SAP 考試的重要內容，涉及 IAM、加密、安全服務和合規性等關鍵知識點。AWS 共同責任模型是理解 AWS 安全性的基礎。</p>
        <p>AWS 共同責任模型明確劃分了 AWS 與客戶之間的安全責任：AWS 負責「雲的安全」（基礎設施、硬件、軟件、設施和網絡），而客戶負責「雲中的安全」（客戶數據、平台、應用程序、身份管理、客戶端和服務器端加密、網絡流量保護等）。理解這一模型對於正確實施安全策略至關重要。</p>
    </div>
    
    <h2>IAM (身份和訪問管理)</h2>
    
    <h3>IAM 用戶、組和角色</h3>
    <ul>
        <li>用戶：代表使用 AWS 的個人或服務
            <ul>
                <li>每個用戶有唯一的安全憑證 - 包括用戶名、密碼、訪問密鑰 ID 和秘密訪問密鑰</li>
                <li>可以是人類用戶或系統用戶 - 人類用戶通常通過 AWS 管理控制台登錄，而系統用戶（如應用程序）則使用訪問密鑰進行編程訪問</li>
                <li>應遵循最小權限原則 - 僅授予完成任務所需的最低權限，減少安全風險</li>
                <li>長期憑證 - IAM 用戶的憑證是長期有效的，需要定期輪換以增強安全性</li>
            </ul>
        </li>
        <li>組：用戶的集合，便於權限管理
            <ul>
                <li>將策略附加到組而不是單個用戶 - 例如，可以創建「開發者」、「管理員」和「審計員」等組，並為每個組分配適當的權限</li>
                <li>用戶可以屬於多個組 - 一個用戶可以同時是「開發者」和「數據分析」組的成員，繼承兩個組的所有權限</li>
                <li>簡化權限管理 - 當需要更改權限時，只需修改組策略，所有組成員自動獲得更新的權限，無需逐個修改用戶</li>
                <li>便於組織結構映射 - 可以根據部門、職能或項目團隊創建組，使權限結構與組織結構保持一致</li>
            </ul>
        </li>
        <li>角色：可由用戶、應用程序或 AWS 服務臨時擔任的身份
            <ul>
                <li>提供臨時安全憑證 - 通過 AWS Security Token Service (STS) 生成，有效期限為 15 分鐘到 36 小時，過期後自動失效</li>
                <li>用於跨賬戶訪問 - 例如，允許開發團隊從生產賬戶臨時訪問測試賬戶的資源，無需在每個賬戶中創建 IAM 用戶</li>
                <li>用於 EC2 實例和其他 AWS 服務的權限 - 通過 EC2 實例配置文件將角色附加到 EC2 實例，使實例上運行的應用程序可以安全地訪問其他 AWS 服務，無需硬編碼憑證</li>
                <li>支持聯合身份用戶 - 企業用戶可以使用現有的身份提供商（如 Active Directory）憑證通過聯合身份驗證臨時擔任 AWS 角色</li>
                <li>信任策略 - 每個角色都有一個信任策略，定義哪些實體（用戶、服務或其他 AWS 賬戶）可以擔任該角色</li>
            </ul>
        </li>
    </ul>
    
    <div class="note">
        <p>考試要點：了解何時使用 IAM 用戶、組和角色。特別是角色在跨賬戶訪問和為 AWS 服務提供權限方面的應用。</p>
        <p>使用場景對比：</p>
        <ul>
            <li>IAM 用戶：適用於需要直接訪問 AWS 的特定個人或服務，如組織內的管理員或需要長期訪問權限的應用程序</li>
            <li>IAM 組：適用於管理具有相似職責的多個用戶的權限，如開發團隊、運維團隊或財務部門</li>
            <li>IAM 角色：適用於臨時訪問場景，如 EC2 實例需要訪問 S3、Lambda 函數需要訪問 DynamoDB、外部合作夥伴需要有限訪問您的 AWS 資源，或實現聯合身份訪問</li>
        </ul>
        <p>實際案例：一個典型的企業可能使用 IAM 角色讓 EC2 實例訪問 S3 存儲桶，使用聯合身份讓員工通過公司目錄登錄 AWS，使用跨賬戶角色實現開發環境和生產環境之間的受控訪問。</p>
    </div>
    
    <h3>IAM 策略</h3>
    <ul>
        <li>基於 JSON 的權限策略文檔 - 定義允許或拒絕對 AWS 資源執行的操作</li>
        <li>策略類型：
            <ul>
                <li>身份策略：附加到 IAM 身份（用戶、組或角色）- 定義該身份可以執行的操作，例如允許開發者啟動 EC2 實例但不能修改 IAM 策略</li>
                <li>資源策略：附加到資源（如 S3 存儲桶、SQS 隊列）- 定義誰可以訪問該資源以及可以執行的操作，例如允許特定 AWS 賬戶讀取但不能寫入 S3 存儲桶</li>
                <li>服務控制策略 (SCP)：用於 AWS Organizations - 設置組織中所有賬戶的最大權限邊界，例如防止成員賬戶使用特定區域或服務</li>
                <li>權限邊界：設置身份可以擁有的最大權限 - 即使附加了更寬鬆的策略，也不會超過邊界定義的權限範圍，常用於委派管理權限</li>
                <li>會話策略：限制通過擔任角色獲得的臨時憑證的權限 - 可以在運行時進一步限制角色權限</li>
            </ul>
        </li>
        <li>策略評估邏輯：
            <ul>
                <li>默認拒絕所有請求 - AWS 採用「默認拒絕」模型，除非明確允許，否則所有請求都被拒絕</li>
                <li>顯式允許覆蓋默認拒絕 - 如果任何適用的策略包含允許特定操作的聲明，則該操作被允許</li>
                <li>顯式拒絕覆蓋任何允許 - 如果任何適用的策略包含拒絕特定操作的聲明，則該操作被拒絕，即使其他策略允許也無效</li>
                <li>同時評估所有適用的策略 - 包括身份策略、資源策略、SCP、權限邊界和會話策略</li>
                <li>評估順序：首先檢查是否有顯式拒絕，然後檢查是否有顯式允許，最後應用默認拒絕</li>
            </ul>
        </li>
        <li>策略元素：
            <ul>
                <li>Effect：Allow 或 Deny - 指定策略聲明是允許還是拒絕訪問</li>
                <li>Action：服務和操作 - 使用格式 "service:action"，如 "s3:GetObject" 或 "ec2:RunInstances"</li>
                <li>Resource：操作適用的資源 - 使用 Amazon Resource Name (ARN) 指定資源，如 "arn:aws:s3:::my-bucket/*"</li>
                <li>Condition：何時應用策略 - 基於特定條件控制策略何時生效，如 IP 地址範圍、時間、標籤或請求參數</li>
                <li>Principal：（僅用於資源策略）指定允許或拒絕訪問的實體，如 IAM 用戶、角色、AWS 賬戶或服務</li>
            </ul>
        </li>
        <li>策略示例：
            <pre>
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "s3:GetObject",
        "s3:ListBucket"
      ],
      "Resource": [
        "arn:aws:s3:::example-bucket",
        "arn:aws:s3:::example-bucket/*"
      ],
      "Condition": {
        "IpAddress": {
          "aws:SourceIp": "203.0.113.0/24"
        }
      }
    }
  ]
}
            </pre>
            <p>此策略允許從特定 IP 範圍讀取和列出 "example-bucket" 中的對象。</p>
        </li>
    </ul>
    
    <div class="important">
        <p>最佳實踐：遵循最小權限原則，只授予完成任務所需的最小權限。使用 IAM Access Analyzer 識別過於寬鬆的權限。</p>
        <p>實施最小權限的步驟：</p>
        <ol>
            <li>從最小權限開始，根據需要逐步添加</li>
            <li>使用 AWS 托管策略作為起點，然後根據特定需求自定義</li>
            <li>利用 IAM Access Advisor 查看服務的上次訪問時間，移除未使用的權限</li>
            <li>定期審查和修改權限，確保它們仍然適合當前需求</li>
            <li>使用條件元素進一步限制訪問，如基於時間、IP 地址或多因素認證狀態</li>
        </ol>
        <p>IAM Access Analyzer 功能：自動分析資源策略，識別允許外部實體訪問資源的策略，幫助防止意外的公共或跨賬戶訪問。它還可以生成策略，基於 CloudTrail 日誌中的訪問活動。</p>
    </div>
    
    <h3>跨賬戶訪問</h3>
    <ul>
        <li>使用 IAM 角色實現跨賬戶訪問
            <ul>
                <li>在目標賬戶中創建角色 - 例如，在生產賬戶中創建一個 "DeveloperAccess" 角色</li>
                <li>在角色信任策略中指定源賬戶 - 允許開發賬戶（賬戶 ID：123456789012）中的實體擔任該角色</li>
                <li>源賬戶中的用戶或服務可以擔任該角色 - 使用 AWS STS AssumeRole API 獲取臨時憑證</li>
                <li>實施步驟：
                    <ol>
                        <li>在目標賬戶中創建角色並定義權限策略（指定允許的操作）</li>
                        <li>配置信任策略，指定哪些賬戶可以擔任該角色</li>
                        <li>在源賬戶中，授予用戶或服務擔任目標角色的權限（sts:AssumeRole）</li>
                        <li>用戶或應用程序調用 AssumeRole API 獲取臨時憑證</li>
                    </ol>
                </li>
            </ul>
        </li>
        <li>資源策略允許其他賬戶訪問資源
            <ul>
                <li>適用於支持資源策略的服務（如 S3、SNS、SQS、KMS、Lambda）</li>
                <li>可以直接在策略中指定外部賬戶 - 無需創建角色或切換身份</li>
                <li>資源策略示例（S3 存儲桶策略）：
                    <pre>
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::123456789012:root"
      },
      "Action": [
        "s3:GetObject",
        "s3:ListBucket"
      ],
      "Resource": [
        "arn:aws:s3:::shared-reports",
        "arn:aws:s3:::shared-reports/*"
      ]
    }
  ]
}
                    </pre>
                    <p>此策略允許賬戶 123456789012 讀取 "shared-reports" 存儲桶中的對象。</p>
                </li>
                <li>與角色的區別：資源策略直接授予訪問權限，用戶使用自己的身份訪問資源；而角色要求用戶先切換身份（擔任角色）</li>
            </ul>
        </li>
        <li>AWS Organizations 提供集中管理多個 AWS 賬戶
            <ul>
                <li>使用服務控制策略 (SCP) 限制成員賬戶的權限 - 即使賬戶管理員也無法超越 SCP 設置的限制</li>
                <li>集中管理和治理 - 創建組織單位 (OU) 結構，按部門、環境或工作負載類型組織賬戶</li>
                <li>SCP 示例：
                    <pre>
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Deny",
      "Action": [
        "ec2:RunInstances",
        "rds:CreateDBInstance"
      ],
      "Resource": "*",
      "Condition": {
        "StringNotEquals": {
          "aws:RequestedRegion": [
            "us-east-1",
            "eu-west-1"
          ]
        }
      }
    }
  ]
}
                    </pre>
                    <p>此 SCP 防止組織中的賬戶在指定區域之外啟動 EC2 實例或 RDS 數據庫。</p>
                </li>
                <li>SCP 與 IAM 策略的關係：SCP 不授予權限，只設置權限邊界；用戶仍需要通過 IAM 策略獲得實際權限</li>
                <li>其他功能：集中計費、跨賬戶 IAM 角色、整合其他 AWS 服務（如 Config、CloudTrail）</li>
            </ul>
        </li>
    </ul>
    
    <h3>聯合身份驗證</h3>
    <ul>
        <li>支持與企業身份提供商集成 (SAML 2.0)
            <ul>
                <li>與 Active Directory、Okta、OneLogin、Ping Identity 等集成 - 利用現有的企業身份系統</li>
                <li>用戶使用現有的企業憑證登錄 - 單點登錄體驗，無需記住額外的 AWS 憑證</li>
                <li>無需創建 IAM 用戶 - 減少管理開銷，提高安全性</li>
                <li>工作流程：
                    <ol>
                        <li>用戶通過企業身份提供商 (IdP) 進行身份驗證</li>
                        <li>IdP 返回 SAML 斷言（包含用戶身份和屬性信息）</li>
                        <li>用戶的瀏覽器將 SAML 斷言提交給 AWS SAML 端點</li>
                        <li>AWS STS 驗證斷言並返回臨時安全憑證</li>
                        <li>用戶使用這些憑證訪問 AWS 資源</li>
                    </ol>
                </li>
                <li>基於屬性的訪問控制 - 根據用戶在企業目錄中的屬性（如部門、職位、位置）動態分配 AWS 權限</li>
            </ul>
        </li>
        <li>AWS IAM Identity Center (前身為 AWS Single Sign-On) 提供集中管理用戶訪問
            <ul>
                <li>集中管理多個 AWS 賬戶的訪問 - 通過單一界面管理所有賬戶的用戶權限</li>
                <li>與 Active Directory 和其他 IdP 集成 - 支持 SAML 2.0 協議的身份提供商</li>
                <li>基於屬性的訪問控制 - 根據用戶屬性自動分配權限</li>
                <li>內置身份存儲 - 可以在 IAM Identity Center 中直接創建和管理用戶，無需外部 IdP</li>
                <li>權限集 - 預定義的權限集合，可以跨多個賬戶分配給用戶和組</li>
                <li>與 AWS Organizations 深度集成 - 自動發現組織中的所有賬戶</li>
                <li>應用程序集成 - 除了 AWS 賬戶外，還可以管理對 Salesforce、Office 365 等第三方應用的訪問</li>
            </ul>
        </li>
        <li>支持 Web 身份聯合 (如 Amazon, Facebook, Google)
            <ul>
                <li>使用 Amazon Cognito 簡化移動和 Web 應用的身份驗證 - 提供完整的身份驗證和授權解決方案</li>
                <li>支持匿名訪問 - 允許未經身份驗證的用戶訪問某些資源，稍後可以轉換為已驗證身份</li>
                <li>提供用戶池和身份池：
                    <ul>
                        <li>用戶池 (User Pools) - 提供用戶目錄、註冊和登錄功能、多因素認證、自定義工作流等</li>
                        <li>身份池 (Identity Pools) - 為用戶提供臨時 AWS 憑證，允許直接訪問 AWS 服務</li>
                    </ul>
                </li>
                <li>工作流程：
                    <ol>
                        <li>用戶通過 Cognito 用戶池或社交身份提供商（如 Google）進行身份驗證</li>
                        <li>身份驗證成功後，用戶獲得身份令牌</li>
                        <li>應用程序使用此令牌從 Cognito 身份池請求臨時 AWS 憑證</li>
                        <li>應用程序使用這些臨時憑證直接訪問 AWS 服務（如 S3、DynamoDB）</li>
                    </ol>
                </li>
                <li>安全功能 - 內置保護，如自適應身份驗證、風險評估、高級安全功能</li>
                <li>可擴展性 - 支持數百萬用戶，自動擴展以滿足需求</li>
            </ul>
        </li>
    </ul>
    
    <div class="note">
        <p>考試要點：了解不同聯合身份驗證方法的適用場景，特別是企業用戶和移動/Web 應用用戶的不同解決方案。</p>
        <p>聯合身份驗證方法對比：</p>
        <table border="1" style="border-collapse: collapse; width: 100%;">
            <tr>
                <th>方法</th>
                <th>適用場景</th>
                <th>主要優勢</th>
                <th>注意事項</th>
            </tr>
            <tr>
                <td>SAML 2.0</td>
                <td>企業用戶訪問 AWS 資源、大型組織、需要與現有身份系統集成</td>
                <td>利用現有企業身份系統、單點登錄體驗、集中身份管理、基於屬性的訪問控制</td>
                <td>設置較複雜、需要 IdP 配置、不適合移動應用</td>
            </tr>
            <tr>
                <td>IAM Identity Center</td>
                <td>管理多個 AWS 賬戶訪問、需要集中管理用戶和權限</td>
                <td>簡化多賬戶訪問管理、與 Organizations 集成、內置身份存儲選項、預定義權限集</td>
                <td>主要針對 AWS 資源訪問、第三方應用集成有限</td>
            </tr>
            <tr>
                <td>Web 身份聯合 (Cognito)</td>
                <td>移動和 Web 應用、消費者應用、需要支持社交登錄</td>
                <td>支持多種身份提供商、用戶管理功能、自適應身份驗證、可擴展到數百萬用戶</td>
                <td>配置複雜度較高、需要前端集成、成本隨用戶數增加</td>
            </tr>
        </table>
    </div>
    
    <h2>數據加密</h2>
    
    <h3>靜態加密</h3>
    <ul>
        <li>S3 支持服務器端加密
            <ul>
                <li>SSE-S3：使用 Amazon S3 管理的密鑰 - Amazon S3 自動處理加密和解密，使用 AES-256 加密算法，密鑰由 AWS 管理，客戶無需管理密鑰</li>
                <li>SSE-KMS：使用 AWS KMS 管理的密鑰 - 提供額外的控制層，包括密鑰使用的審計跟踪、密鑰輪換選項和對密鑰的訪問控制</li>
                <li>SSE-C：使用客戶提供的密鑰 - 客戶提供和管理自己的加密密鑰，AWS 使用這些密鑰加密數據但不存儲密鑰</li>
                <li>可以使用存儲桶策略強制加密 - 例如，可以拒絕未使用加密標頭的上傳請求，確保所有新對象都被加密</li>
                <li>客戶端加密 - 在數據發送到 S3 之前在客戶端加密數據，AWS 完全不知道加密密鑰</li>
            </ul>
        </li>
        <li>EBS 卷加密
            <ul>
                <li>使用 KMS 密鑰加密 - 在 EC2 實例和 EBS 存儲之間傳輸的數據會自動加密，存儲在卷上的數據也會加密</li>
                <li>可以設置默認加密 - 在區域級別啟用，確保所有新創建的 EBS 卷都自動加密</li>
                <li>加密卷的快照自動加密 - 從加密卷創建的快照自動加密，從這些快照創建的新卷也自動加密</li>
                <li>加密過程對應用程序透明 - 無需修改應用程序代碼，對性能影響最小</li>
                <li>加密和解密在 EC2 主機上進行 - 由 AWS Nitro 系統處理，減少對實例性能的影響</li>
            </ul>
        </li>
        <li>RDS 和 DynamoDB 加密
            <ul>
                <li>RDS 支持靜態加密和 TDE（透明數據加密）
                    <ul>
                        <li>靜態加密 - 加密數據庫實例、自動備份、快照和事務日誌</li>
                        <li>TDE - 特定於數據庫引擎的加密（如 Oracle TDE、SQL Server TDE），在數據寫入存儲之前加密</li>
                        <li>不同數據庫引擎支持不同的加密選項 - 例如，Oracle 和 SQL Server 支持 TDE，所有引擎都支持 KMS 加密</li>
                    </ul>
                </li>
                <li>DynamoDB 支持表級加密
                    <ul>
                        <li>默認啟用加密 - 所有 DynamoDB 表都自動加密</li>
                        <li>加密範圍 - 包括表數據、本地和全局二級索引、流、全局表和備份</li>
                        <li>無性能影響 - 加密和解密過程對應用程序透明，不影響性能</li>
                    </ul>
                </li>
                <li>可以使用 AWS 管理的密鑰或客戶管理的密鑰
                    <ul>
                        <li>AWS 擁有的密鑰 - 默認選項，由 AWS 完全管理</li>
                        <li>AWS 管理的密鑰 - 在客戶賬戶中創建，但由 AWS 管理</li>
                        <li>客戶管理的密鑰 - 客戶在 KMS 中創建和管理，提供最大控制權</li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
    
    <h3>傳輸中加密</h3>
    <ul>
        <li>HTTPS/TLS 用於 API 和網站
            <ul>
                <li>AWS Certificate Manager 提供免費的 SSL/TLS 證書
                    <ul>
                        <li>自動續期 - 證書自動續期，無需手動干預</li>
                        <li>支持公共和私有證書 - 公共證書用於面向互聯網的應用，私有證書用於內部資源</li>
                        <li>支持通配符證書 - 保護多個子域</li>
                    </ul>
                </li>
                <li>與 CloudFront 和 ALB 集成
                    <ul>
                        <li>一鍵部署 - 直接將證書部署到 CloudFront 分配或 ALB</li>
                        <li>終止 TLS - 在 AWS 邊緣位置或負載均衡器處理 TLS 終止，減輕後端服務器負擔</li>
                        <li>支持最新的 TLS 協議和密碼套件 - 自動更新以支持最新的安全標準</li>
                    </ul>
                </li>
                <li>安全策略 - 可以配置支持的 TLS 版本和密碼套件，平衡安全性和兼容性</li>
                <li>HTTPS 重定向 - 可以配置 ALB 自動將 HTTP 請求重定向到 HTTPS</li>
            </ul>
        </li>
        <li>VPN 和 Direct Connect 提供加密連接
            <ul>
                <li>Site-to-Site VPN 提供 IPsec 加密
                    <ul>
                        <li>連接本地網絡和 AWS VPC - 通過公共互聯網建立加密隧道</li>
                        <li>支持靜態和動態路由 - 使用 BGP 進行動態路由交換</li>
                        <li>高可用性 - 支持多個隧道和故障轉移</li>
                        <li>加密算法 - 支持多種加密和完整性算法，如 AES-256、SHA-2</li>
                    </ul>
                </li>
                <li>Direct Connect 可以與 VPN 結合使用提供加密
                    <ul>
                        <li>Direct Connect 本身不加密 - 提供專用網絡連接，但默認不加密</li>
                        <li>Direct Connect + VPN - 在 Direct Connect 連接上運行 VPN，結合專用連接的可靠性和 VPN 的加密</li>
                        <li>Direct Connect 公共 VIF + VPN - 通過公共虛擬接口運行 VPN</li>
                        <li>Direct Connect 私有 VIF + VPN - 通過私有虛擬接口運行 VPN，提供最高安全性</li>
                    </ul>
                </li>
                <li>Client VPN - 為遠程用戶提供安全訪問 AWS 和本地網絡
                    <ul>
                        <li>基於 OpenVPN - 使用開源 OpenVPN 協議</li>
                        <li>支持多種身份驗證方法 - 包括證書、Active Directory 和 SAML 2.0</li>
                        <li>細粒度訪問控制 - 基於安全組和網絡 ACL</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>PrivateLink 提供私有連接，避免通過公共互聯網
            <ul>
                <li>私有連接到 AWS 服務和 VPC 端點服務 - 數據不經過公共互聯網</li>
                <li>安全優勢
                    <ul>
                        <li>減少暴露面 - 服務不需要公共 IP 地址</li>
                        <li>簡化安全組管理 - 無需允許來自互聯網的流量</li>
                        <li>增強數據隱私 - 流量不離開 AWS 網絡</li>
                    </ul>
                </li>
                <li>支持的服務 - 包括 S3、DynamoDB、CloudWatch、SNS、SQS 等多種 AWS 服務</li>
                <li>VPC 端點類型
                    <ul>
                        <li>接口端點 - 為大多數 AWS 服務創建彈性網絡接口</li>
                        <li>網關端點 - 為 S3 和 DynamoDB 提供路由表條目</li>
                    </ul>
                </li>
                <li>跨區域和跨賬戶訪問 - 支持不同區域和賬戶之間的私有連接</li>
            </ul>
        </li>
    </ul>
    
    <div class="important">
        <p>合規要求：許多合規標準（如 PCI DSS、HIPAA）要求數據在靜態和傳輸中都必須加密。了解如何在 AWS 上實現端到端加密。</p>
        <p>主要合規標準加密要求：</p>
        <ul>
            <li>PCI DSS（支付卡行業數據安全標準）
                <ul>
                    <li>要求保護持卡人數據，包括存儲、處理和傳輸</li>
                    <li>要求使用強加密算法（如 AES-256）</li>
                    <li>要求安全密鑰管理流程，包括密鑰生成、分發、存儲和輪換</li>
                </ul>
            </li>
            <li>HIPAA（健康保險可攜性和責任法案）
                <ul>
                    <li>要求保護電子保護健康信息 (ePHI)</li>
                    <li>要求實施技術保障措施，包括加密和解密</li>
                    <li>不指定特定加密標準，但建議遵循 NIST 指南</li>
                </ul>
            </li>
            <li>GDPR（通用數據保護條例）
                <ul>
                    <li>建議使用加密作為保護個人數據的技術措施</li>
                    <li>加密數據可能減輕數據泄露通知要求</li>
                </ul>
            </li>
        </ul>
        <p>AWS 端到端加密實現：</p>
        <ol>
            <li>靜態數據 - 使用 S3 加密、EBS 加密、RDS 加密等服務</li>
            <li>傳輸中數據 - 使用 TLS/SSL、VPN、PrivateLink</li>
            <li>密鑰管理 - 使用 AWS KMS 管理加密密鑰</li>
            <li>密碼和機密 - 使用 Secrets Manager 或 Parameter Store 安全存儲</li>
            <li>監控和審計 - 使用 CloudTrail 記錄加密相關操作</li>
        </ol>
    </div>
    
    <h3>AWS Key Management Service (KMS)</h3>
    <ul>
        <li>創建和管理加密密鑰
            <ul>
                <li>客戶主密鑰 (CMK) 用於加密數據 - 現在稱為 KMS 密鑰，是 KMS 中的主要資源</li>
                <li>支持對稱和非對稱密鑰
                    <ul>
                        <li>對稱密鑰 - 使用相同的密鑰進行加密和解密，支持最多 4KB 數據的加密</li>
                        <li>非對稱密鑰 - 使用公鑰/私鑰對，支持加密/解密和簽名/驗證操作</li>
                    </ul>
                </li>
                <li>密鑰永不離開 KMS 未加密 - 加密操作在 KMS 內部進行，提高安全性</li>
                <li>信封加密 - 用於加密大於 4KB 的數據，KMS 生成數據密鑰，然後使用 KMS 密鑰加密數據密鑰</li>
            </ul>
        </li>
        <li>密鑰類型
            <ul>
                <li>AWS 管理的密鑰：由 AWS 服務自動創建和管理
                    <ul>
                        <li>命名格式：aws/service-name（如 aws/s3、aws/ebs）</li>
                        <li>自動輪換 - 每年自動輪換</li>
                        <li>無額外費用 - 使用 AWS 服務時包含</li>
                        <li>有限控制 - 客戶無法刪除或更改策略</li>
                    </ul>
                </li>
                <li>客戶管理的密鑰：由客戶創建和管理
                    <ul>
                        <li>完全控制 - 客戶控制密鑰策略、輪換、別名等</li>
                        <li>可以啟用或禁用 - 臨時阻止使用</li>
                        <li>支持導入的密鑰材料 - 可以使用自己的密鑰材料</li>
                        <li>收費 - 按月收費，加上 API 調用費用</li>
                    </ul>
                </li>
                <li>AWS 擁有的密鑰：由 AWS 擁有和管理，客戶無法查看或管理
                    <ul>
                        <li>多個 AWS 賬戶共享 - 不特定於單個客戶賬戶</li>
                        <li>客戶不可見 - 在 KMS 控制台中不可見</li>
                        <li>由 AWS 服務在後台使用 - 客戶無需管理</li>
                    </ul>
                </li>
                <li>自定義密鑰存儲：使用外部密鑰管理系統
                    <ul>
                        <li>外部密鑰存儲 (XKS) - 在外部密鑰管理器中保留密鑰材料</li>
                        <li>AWS CloudHSM 密鑰存儲 - 使用 CloudHSM 集群作為密鑰存儲</li>
                        <li>雙層控制 - 結合 AWS KMS 和外部系統的控制</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>密鑰策略和授權
            <ul>
                <li>密鑰策略控制對密鑰的訪問
                    <ul>
                        <li>基於資源的策略 - 每個 KMS 密鑰必須有一個密鑰策略</li>
                        <li>默認策略 - 如果未指定，授予密鑰管理員完全控制權</li>
                        <li>與 IAM 策略結合 - 密鑰策略可以允許 IAM 策略進一步限制訪問</li>
                    </ul>
                </li>
                <li>授權允許臨時訪問
                    <ul>
                        <li>委派權限 - 允許 KMS 密鑰擁有者向 AWS 服務或其他主體授予臨時權限</li>
                        <li>精細控制 - 指定特定操作和條件</li>
                        <li>使用案例 - 常用於 AWS 服務集成，如 S3 使用 KMS 加密對象</li>
                        <li>生命週期管理 - 可以創建、查看、撤銷授權</li>
                    </ul>
                </li>
                <li>支持多區域密鑰
                    <ul>
                        <li>跨區域兼容 - 在一個區域加密的數據可以在另一個區域解密</li>
                        <li>主密鑰和副本 - 一個主區域密鑰和多個副本區域密鑰</li>
                        <li>共享屬性 - 密鑰 ID、密鑰材料和其他屬性在所有區域相同</li>
                        <li>獨立策略 - 每個區域的密鑰可以有不同的密鑰策略</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>與多種 AWS 服務集成
            <ul>
                <li>S3、EBS、RDS、DynamoDB 等
                    <ul>
                        <li>透明集成 - 在服務控制台中選擇 KMS 加密選項</li>
                        <li>服務特定的實現 - 每個服務以不同方式使用 KMS</li>
                        <li>雙重加密 - 某些服務（如 S3）可能在多個層次使用加密</li>
                    </ul>
                </li>
                <li>支持信封加密
                    <ul>
                        <li>工作原理 - 使用數據密鑰加密數據，然後使用 KMS 密鑰加密數據密鑰</li>
                        <li>優勢 - 提高性能（只有小的數據密鑰需要通過 KMS 處理），增強安全性</li>
                        <li>GenerateDataKey API - 生成用於信封加密的數據密鑰</li>
                        <li>Decrypt API - 解密加密的數據密鑰，然後使用解密的數據密鑰解密數據</li>
                    </ul>
                </li>
                <li>密鑰使用上下文 - 提供額外的身份驗證數據 (AAD)，增強安全性</li>
            </ul>
        </li>
        <li>密鑰輪換
            <ul>
                <li>AWS 管理的密鑰自動每年輪換
                    <ul>
                        <li>無需客戶操作 - AWS 自動處理</li>
                        <li>透明過程 - 不影響使用密鑰的應用程序</li>
                    </ul>
                </li>
                <li>客戶管理的密鑰可以配置自動輪換
                    <ul>
                        <li>可選功能 - 默認禁用，可以啟用</li>
                        <li>輪換間隔 - 每年輪換一次</li>
                        <li>僅適用於對稱加密密鑰 - 非對稱密鑰需要手動輪換</li>
                    </ul>
                </li>
                <li>輪換保留舊版本的密鑰用於解密
                    <ul>
                        <li>向後兼容 - 使用舊密鑰版本加密的數據仍然可以解密</li>
                        <li>密鑰版本 - KMS 維護密鑰的所有版本</li>
                        <li>透明選擇 - KMS 自動選擇正確的密鑰版本進行解密</li>
                    </ul>
                </li>
                <li>手動輪換 - 創建新密鑰並更新應用程序以使用新密鑰
                    <ul>
                        <li>適用於所有密鑰類型 - 包括非對稱密鑰</li>
                        <li>使用別名 - 更新別名以指向新密鑰，簡化應用程序更新</li>
                        <li>完全控制 - 自定義輪換間隔和過程</li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
    
    <div class="note">
        <p>考試要點：了解 KMS 密鑰類型和使用場景，特別是客戶管理的密鑰與 AWS 管理的密鑰的區別，以及密鑰策略的配置。</p>
        <p>密鑰類型選擇指南：</p>
        <table border="1" style="border-collapse: collapse; width: 100%;">
            <tr>
                <th>需求</th>
                <th>推薦密鑰類型</th>
                <th>原因</th>
            </tr>
            <tr>
                <td>基本加密，最小管理開銷</td>
                <td>AWS 管理的密鑰</td>
                <td>自動創建和輪換，無需額外配置</td>
            </tr>
            <tr>
                <td>需要控制密鑰策略和訪問</td>
                <td>客戶管理的密鑰</td>
                <td>完全控制密鑰策略、別名和輪換設置</td>
            </tr>
            <tr>
                <td>合規要求（如 FIPS 140-2 Level 3）</td>
                <td>CloudHSM 密鑰存儲中的客戶管理密鑰</td>
                <td>提供更高的安全保證和專用硬件</td>
            </tr>
            <tr>
                <td>需要使用自己的密鑰材料</td>
                <td>帶導入密鑰材料的客戶管理密鑰</td>
                <td>可以使用在外部生成的密鑰材料</td>
            </tr>
            <tr>
                <td>需要在多個區域使用相同密鑰</td>
                <td>多區域客戶管理密鑰</td>
                <td>在不同區域使用相同的密鑰材料</td>
            </tr>
        </table>
        <p>密鑰策略最佳實踐：</p>
        <ul>
            <li>遵循最小權限原則 - 只授予必要的權限</li>
            <li>使用條件限制訪問 - 如 IP 地址範圍、時間限制</li>
            <li>分離管理和使用權限 - 不同角色負責不同操作</li>
            <li>啟用密鑰輪換 - 增強長期安全性</li>
            <li>使用別名管理密鑰 - 簡化密鑰引用和輪換</li>
        </ul>
    </div>
    
    <h3>AWS Secrets Manager</h3>
    <ul>
        <li>安全存儲和管理敏感信息，如數據庫憑證
            <ul>
                <li>集中管理密碼、API 密鑰和其他機密
                    <ul>
                        <li>減少硬編碼憑證 - 應用程序可以在運行時檢索機密，而不是在代碼中硬編碼</li>
                        <li>支持多種類型的機密 - 數據庫憑證、API 密鑰、OAuth 令牌、任意文本等</li>
                        <li>版本控制 - 跟踪機密的更改歷史</li>
                    </ul>
                </li>
                <li>使用 KMS 加密機密
                    <ul>
                        <li>默認使用 AWS 管理的密鑰 - 自動加密所有存儲的機密</li>
                        <li>支持客戶管理的密鑰 - 提供更多控制和審計能力</li>
                        <li>加密傳輸 - 所有 API 調用都通過 HTTPS 進行</li>
                    </ul>
                </li>
                <li>支持細粒度的訪問控制
                    <ul>
                        <li>基於 IAM 的權限 - 控制誰可以創建、更新、檢索或刪除機密</li>
                        <li>資源策略 - 類似 S3 存儲桶策略，可以授予跨賬戶訪問權限</li>
                        <li>VPC 端點支持 - 可以從 VPC 內部私有訪問，無需通過公共互聯網</li>
                    </ul>
                </li>
                <li>與 AWS 服務集成
                    <ul>
                        <li>CloudFormation 集成 - 在基礎設施即代碼中管理機密</li>
                        <li>Lambda 環境變量 - 安全地引用機密</li>
                        <li>ECS/EKS 集成 - 將機密注入容器</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>支持自動輪換密鑰
            <ul>
                <li>內置對 RDS、Redshift 和 DocumentDB 的支持
                    <ul>
                        <li>自動更新數據庫用戶憑證 - 無需手動干預</li>
                        <li>無縫輪換 - 應用程序始終獲取最新的有效憑證</li>
                        <li>支持多種數據庫引擎 - MySQL、PostgreSQL、Oracle、SQL Server、MariaDB 等</li>
                    </ul>
                </li>
                <li>可以使用 Lambda 函數自定義輪換邏輯
                    <ul>
                        <li>靈活的輪換策略 - 適應任何類型的機密</li>
                        <li>可自定義輪換間隔 - 從 1 天到 365 天</li>
                        <li>輪換過程 - 創建新憑證、測試新憑證、更新機密、清理舊憑證</li>
                    </ul>
                </li>
                <li>減少硬編碼憑證的風險
                    <ul>
                        <li>提高安全性 - 定期更改憑證減少憑證洩露的風險</li>
                        <li>符合合規要求 - 滿足 PCI DSS 等標準的密碼輪換要求</li>
                        <li>簡化操作 - 自動化輪換流程，減少人為錯誤</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>與 RDS、Redshift 和 DocumentDB 集成
            <ul>
                <li>自動生成和管理數據庫憑證
                    <ul>
                        <li>簡化數據庫訪問管理 - 無需手動創建和管理數據庫用戶</li>
                        <li>支持主用戶和應用程序特定用戶 - 可以管理管理員憑證和應用程序憑證</li>
                        <li>自動更新連接字符串 - 輪換時自動更新存儲的連接信息</li>
                    </ul>
                </li>
                <li>支持多用戶和多環境
                    <ul>
                        <li>環境隔離 - 為開發、測試和生產環境使用不同的機密</li>
                        <li>基於標籤的訪問控制 - 使用標籤限制對特定環境機密的訪問</li>
                        <li>命名約定 - 使用路徑和名稱組織機密（如 /dev/db/mysql-1、/prod/db/mysql-1）</li>
                    </ul>
                </li>
                <li>與 Parameter Store 的比較
                    <ul>
                        <li>Secrets Manager 專為機密管理設計 - 提供自動輪換和更高級的安全功能</li>
                        <li>Parameter Store 更通用 - 可以存儲配置數據和機密，成本更低</li>
                        <li>選擇指南 - 需要自動輪換或跨賬戶共享時使用 Secrets Manager；對於簡單的參數存儲或成本敏感的場景使用 Parameter Store</li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
    
    <h2>安全服務</h2>
    
    <h3>AWS Shield</h3>
    <ul>
        <li>提供 DDoS 防護
            <ul>
                <li>Shield Standard：免費提供基本保護
                    <ul>
                        <li>自動包含在所有 AWS 服務中 - 無需額外配置或費用</li>
                        <li>防禦常見的網絡層攻擊（第 3 層和第 4 層）- 如 SYN/UDP 洪水、反射攻擊</li>
                        <li>與 AWS 全球邊緣網絡集成 - 在靠近攻擊源頭處緩解攻擊</li>
                    </ul>
                </li>
                <li>Shield Advanced：提供高級保護和 24x7 響應團隊
                    <ul>
                        <li>付費服務 - 提供增強的 DDoS 保護功能</li>
                        <li>應用層（第 7 層）保護 - 結合 AWS WAF 防禦更複雜的攻擊</li>
                        <li>專家支持 - 訪問 AWS DDoS 響應團隊 (DRT) 進行事件響應</li>
                    </ul>
                </li>
                <li>保護 EC2、ELB、CloudFront、Global Accelerator 和 Route 53
                    <ul>
                        <li>全面覆蓋 - 保護 AWS 上的關鍵基礎設施組件</li>
                        <li>彈性擴展 - 自動擴展以吸收大規模攻擊</li>
                        <li>全球部署 - 在 AWS 全球網絡中分散攻擊流量</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>Shield Standard
            <ul>
                <li>自動包含在所有 AWS 服務中
                    <ul>
                        <li>默認啟用 - 所有 AWS 客戶自動獲得保護</li>
                        <li>無需配置 - 透明運行，無需管理</li>
                        <li>無需部署額外資源 - 內置於 AWS 基礎設施</li>
                    </ul>
                </li>
                <li>防禦常見的網絡和傳輸層 DDoS 攻擊
                    <ul>
                        <li>SYN 洪水攻擊 - 防禦 TCP SYN 洪水攻擊</li>
                        <li>UDP 反射攻擊 - 防禦 DNS、NTP、SSDP 等反射攻擊</li>
                        <li>連接洪水攻擊 - 防禦大量連接請求</li>
                    </ul>
                </li>
                <li>無需額外費用
                    <ul>
                        <li>包含在 AWS 服務費用中 - 無需額外付費</li>
                        <li>基本保護 - 適用於大多數常見攻擊場景</li>
                        <li>成本效益 - 為所有 AWS 客戶提供基本安全保障</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>Shield Advanced
            <ul>
                <li>提供更高級的保護
                    <ul>
                        <li>增強的檢測和緩解 - 更快識別和響應攻擊</li>
                        <li>應用層保護 - 結合 AWS WAF 防禦第 7 層攻擊</li>
                        <li>主動參與 - 可以配置警報和通知</li>
                        <li>詳細可見性 - 提供攻擊診斷和可視化</li>
                    </ul>
                </li>
                <li>包括 24x7 DDoS 響應團隊
                    <ul>
                        <li>專家支持 - 訪問專門的 DDoS 專家</li>
                        <li>主動參與 - DRT 可以直接幫助配置和緩解攻擊</li>
                        <li>攻擊分析 - 提供詳細的攻擊報告和建議</li>
                        <li>自定義緩解 - 為特定應用程序定制保護措施</li>
                    </ul>
                </li>
                <li>與 AWS WAF 集成提供應用層保護
                    <ul>
                        <li>免費 AWS WAF - Shield Advanced 訂閱包括基本 WAF 使用</li>
                        <li>自定義規則 - 創建特定於應用程序的保護規則</li>
                        <li>速率限制 - 控制請求速率，防止應用層洪水攻擊</li>
                        <li>異常檢測 - 識別不尋常的流量模式</li>
                    </ul>
                </li>
                <li>提供成本保護，防止 DDoS 攻擊期間的流量峰值費用
                    <ul>
                        <li>費用保護 - 可能獲得 DDoS 攻擊期間產生的額外費用的抵免</li>
                        <li>預算可預測性 - 防止攻擊導致的意外費用</li>
                        <li>資源擴展 - 自動擴展以應對攻擊，無需擔心成本</li>
                    </ul>
                </li>
                <li>適用場景
                    <ul>
                        <li>高價值目標 - 經常成為 DDoS 攻擊目標的應用</li>
                        <li>關鍵業務應用 - 需要高可用性的任務關鍵型工作負載</li>
                        <li>合規要求 - 需要證明實施了高級 DDoS 保護措施</li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
    
    <h3>AWS WAF (Web 應用程序防火牆)</h3>
    <ul>
        <li>保護 Web 應用程序免受常見 Web 漏洞攻擊
            <ul>
                <li>防禦 SQL 注入、跨站腳本 (XSS) 等攻擊
                    <ul>
                        <li>SQL 注入防護 - 檢測和阻止嘗試利用 SQL 注入漏洞的請求</li>
                        <li>XSS 防護 - 識別和過濾包含惡意腳本的請求</li>
                        <li>OWASP Top 10 保護 - 防禦常見的 Web 應用程序漏洞</li>
                        <li>路徑遍歷防護 - 防止攻擊者訪問未授權的文件和目錄</li>
                    </ul>
                </li>
                <li>基於規則控制 Web 流量
                    <ul>
                        <li>檢查請求組件 - 檢查 HTTP 標頭、方法、URI、查詢字符串、正文等</li>
                        <li>IP 地址過濾 - 允許或阻止特定 IP 地址或 CIDR 範圍</li>
                        <li>地理位置限制 - 基於請求來源國家/地區控制訪問</li>
                        <li>大小約束 - 限制請求組件的大小，防止緩衝區溢出攻擊</li>
                    </ul>
                </li>
                <li>支持速率限制
                    <ul>
                        <li>請求速率控制 - 限制單個 IP 地址在指定時間內的請求數量</li>
                        <li>防止暴力破解 - 阻止密碼猜測和憑證填充攻擊</li>
                        <li>減輕 DDoS 影響 - 限制應用層 DDoS 攻擊的影響</li>
                        <li>自定義閾值 - 根據應用程序特性設置適當的限制</li>
                    </ul>
                </li>
                <li>機器學習功能
                    <ul>
                        <li>機器人控制 - 識別和管理機器人流量</li>
                        <li>欺詐控制 - 檢測可疑的帳戶創建、登錄嘗試和交易</li>
                        <li>異常檢測 - 識別不尋常的請求模式</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>可以與 CloudFront、ALB 或 API Gateway 集成
            <ul>
                <li>保護全球或區域性的應用程序
                    <ul>
                        <li>CloudFront 集成 - 在全球邊緣位置提供保護，減少延遲</li>
                        <li>ALB 集成 - 在區域級別提供保護，適用於區域性應用</li>
                        <li>API Gateway 集成 - 保護 API 端點免受攻擊</li>
                        <li>AppSync 集成 - 保護 GraphQL API</li>
                    </ul>
                </li>
                <li>支持 IPv4 和 IPv6 流量
                    <ul>
                        <li>雙棧支持 - 同時保護 IPv4 和 IPv6 流量</li>
                        <li>統一規則 - 相同的規則適用於兩種協議</li>
                        <li>未來兼容 - 隨著 IPv6 採用率增加保持保護</li>
                    </ul>
                </li>
                <li>部署選項
                    <ul>
                        <li>全球部署 - 與 CloudFront 一起使用時保護全球分布的應用</li>
                        <li>區域部署 - 與 ALB、API Gateway 一起使用時在特定區域提供保護</li>
                        <li>多層防禦 - 可以在多個層次部署（CDN、負載均衡器等）</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>支持自定義規則和托管規則
            <ul>
                <li>AWS 托管規則提供預配置的保護
                    <ul>
                        <li>核心規則集 - 防禦常見 Web 漏洞</li>
                        <li>管理員保護 - 保護管理界面</li>
                        <li>已知錯誤輸入 - 檢測惡意請求模式</li>
                        <li>SQL 數據庫規則 - 特定於數據庫的 SQL 注入保護</li>
                        <li>定期更新 - AWS 持續更新以應對新威脅</li>
                    </ul>
                </li>
                <li>AWS Marketplace 中的第三方規則
                    <ul>
                        <li>專業安全廠商 - 如 Fortinet、F5、Imperva 等提供的規則</li>
                        <li>專業威脅情報 - 基於專業安全研究的規則</li>
                        <li>特定用例 - 針對特定應用類型或行業的規則</li>
                    </ul>
                </li>
                <li>自定義規則滿足特定需求
                    <ul>
                        <li>可視化規則構建器 - 無需編寫複雜的表達式</li>
                        <li>精確匹配 - 針對應用程序特定需求定制規則</li>
                        <li>正則表達式支持 - 使用正則表達式進行複雜模式匹配</li>
                        <li>邏輯運算符 - 使用 AND、OR、NOT 創建複雜條件</li>
                    </ul>
                </li>
                <li>規則組 - 將多個規則組合為可重用的集合
                    <ul>
                        <li>簡化管理 - 一次應用多個規則</li>
                        <li>共享規則 - 跨多個 Web ACL 重用規則組</li>
                        <li>版本控制 - 管理規則組的不同版本</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>Web ACL (訪問控制列表)
            <ul>
                <li>定義規則和操作
                    <ul>
                        <li>規則優先級 - 按順序評估規則，可以設置優先級</li>
                        <li>規則組合 - 將多個條件組合成單個規則</li>
                        <li>默認操作 - 指定不匹配任何規則的請求的處理方式</li>
                    </ul>
                </li>
                <li>可以允許、阻止或計數匹配的請求
                    <ul>
                        <li>允許 - 放行符合條件的請求</li>
                        <li>阻止 - 拒絕符合條件的請求，返回 403 Forbidden</li>
                        <li>計數 - 允許請求但記錄匹配情況，用於測試和監控</li>
                        <li>CAPTCHA - 要求用戶完成驗證碼挑戰</li>
                        <li>Challenge - 使用 JavaScript 挑戰驗證合法瀏覽器</li>
                    </ul>
                </li>
                <li>支持基於地理位置的限制
                    <ul>
                        <li>國家/地區過濾 - 基於請求來源國家/地區允許或阻止</li>
                        <li>合規要求 - 滿足地理位置限制的合規需求</li>
                        <li>內容限制 - 實施基於地區的內容訪問控制</li>
                    </ul>
                </li>
                <li>日誌和監控
                    <ul>
                        <li>詳細日誌 - 記錄所有匹配的請求詳情</li>
                        <li>與 CloudWatch 集成 - 提供指標和警報</li>
                        <li>與 Kinesis 集成 - 實時流式傳輸日誌</li>
                        <li>與 S3 集成 - 長期存儲日誌用於分析</li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
    
    <div class="important">
        <p>安全最佳實踐：結合使用 AWS Shield 和 AWS WAF 提供全面的 DDoS 和 Web 應用程序保護。Shield 防禦網絡和傳輸層攻擊，WAF 防禦應用層攻擊。</p>
        <p>多層防禦策略：</p>
        <ol>
            <li>邊緣保護：使用 CloudFront 和 Shield 在全球邊緣位置分散和吸收大規模攻擊</li>
            <li>網絡層保護：使用安全組和網絡 ACL 過濾惡意流量</li>
            <li>應用層保護：使用 WAF 防禦 Web 應用程序漏洞</li>
            <li>內容交付優化：使用 CloudFront 緩存減少源站負載</li>
            <li>自動擴展：配置 Auto Scaling 以應對流量峰值</li>
            <li>監控和響應：設置 CloudWatch 警報和 EventBridge 規則自動響應攻擊</li>
        </ol>
        <p>實施建議：</p>
        <ul>
            <li>對關鍵應用使用 Shield Advanced + WAF</li>
            <li>實施速率限制防止暴力破解攻擊</li>
            <li>啟用詳細日誌記錄以分析攻擊模式</li>
            <li>定期審查和更新安全規則</li>
            <li>使用 AWS 托管規則作為基線，然後添加自定義規則</li>
            <li>測試防禦措施（在非生產環境中）</li>
        </ul>
    </div>
    
    <h3>AWS Firewall Manager</h3>
    <ul>
        <li>集中配置和管理防火牆規則
            <ul>
                <li>跨多個賬戶統一管理安全策略
                    <ul>
                        <li>單一控制點 - 從一個位置管理所有賬戶的安全策略</li>
                        <li>一致的安全態勢 - 確保所有賬戶遵循相同的安全標準</li>
                        <li>簡化管理 - 減少在多個賬戶中重複配置的需要</li>
                        <li>分層策略 - 可以按組織單位 (OU) 應用不同的策略</li>
                    </ul>
                </li>
                <li>自動應用規則到新資源
                    <ul>
                        <li>持續監控 - 自動檢測新創建的資源</li>
                        <li>自動修復 - 將策略應用到新資源或不合規資源</li>
                        <li>減少人為錯誤 - 消除手動配置的需要</li>
                        <li>確保一致性 - 所有新資源自動遵循安全標準</li>
                    </ul>
                </li>
                <li>集中監控合規性
                    <ul>
                        <li>合規性儀表板 - 提供所有賬戶和資源的合規性狀態視圖</li>
                        <li>詳細報告 - 識別不合規的資源和原因</li>
                        <li>審計跟踪 - 記錄策略更改和合規性狀態變化</li>
                        <li>與 Security Hub 集成 - 提供更全面的安全態勢視圖</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>跨多個賬戶和應用程序應用規則
            <ul>
                <li>管理 WAF 規則
                    <ul>
                        <li>標準化 Web 保護 - 在所有 Web 應用程序中應用一致的 WAF 規則</li>
                        <li>集中更新 - 一次更新所有賬戶的 WAF 規則</li>
                        <li>自動應用 - 將 WAF 規則自動應用到新的 CloudFront、ALB 或 API Gateway</li>
                        <li>合規性強制執行 - 確保所有 Web 應用程序都受到保護</li>
                    </ul>
                </li>
                <li>管理 Shield Advanced 保護
                    <ul>
                        <li>集中啟用 DDoS 保護 - 為所有關鍵資源啟用 Shield Advanced</li>
                        <li>自動保護 - 將 Shield Advanced 自動應用到新資源</li>
                        <li>標準化保護策略 - 確保所有資源使用相同的 DDoS 保護設置</li>
                        <li>合規性監控 - 識別未受 Shield Advanced 保護的資源</li>
                    </ul>
                </li>
                <li>管理 VPC 安全組
                    <ul>
                        <li>標準化安全組規則 - 在所有 VPC 中應用一致的安全組策略</li>
                        <li>審計安全組 - 識別過於寬鬆或不合規的安全組</li>
                        <li>自動修復 - 修復不符合策略的安全組</li>
                        <li>集中控制 - 管理跨多個 VPC 的安全組規則</li>
                    </ul>
                </li>
                <li>管理 Network Firewall 策略
                    <ul>
                        <li>集中定義防火牆規則 - 為所有 VPC 創建一致的網絡防火牆策略</li>
                        <li>自動部署 - 將 Network Firewall 自動部署到新的 VPC</li>
                        <li>標準化檢查 - 應用一致的狀態檢查、協議檢查和域名過濾</li>
                        <li>合規性監控 - 識別未受 Network Firewall 保護的 VPC</li>
                    </ul>
                </li>
                <li>管理 DNS Firewall 規則組
                    <ul>
                        <li>集中 DNS 保護 - 為所有 VPC 應用一致的 DNS 過濾</li>
                        <li>阻止惡意域名 - 防止與已知惡意域名的通信</li>
                        <li>數據外洩防護 - 控制對未授權 DNS 解析器的訪問</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>與 AWS Organizations 集成
            <ul>
                <li>按組織單位 (OU) 應用策略
                    <ul>
                        <li>分層安全控制 - 根據組織結構應用不同的安全策略</li>
                        <li>環境隔離 - 為開發、測試和生產環境應用不同的策略</li>
                        <li>業務單位特定策略 - 根據業務需求定制安全控制</li>
                        <li>繼承機制 - 子 OU 可以繼承父 OU 的策略</li>
                    </ul>
                </li>
                <li>支持集中合規報告
                    <ul>
                        <li>組織級視圖 - 查看整個組織的安全合規狀態</li>
                        <li>按 OU 分組 - 按組織結構查看合規性報告</li>
                        <li>趨勢分析 - 跟踪合規性狀態隨時間的變化</li>
                        <li>與 AWS Config 集成 - 提供更詳細的合規性報告</li>
                    </ul>
                </li>
                <li>管理員委派
                    <ul>
                        <li>集中管理 - 指定 Firewall Manager 管理員賬戶</li>
                        <li>權限分離 - 將安全管理與其他 AWS 管理分開</li>
                        <li>專用安全賬戶 - 遵循安全最佳實踐</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>使用場景和最佳實踐
            <ul>
                <li>多賬戶環境 - 特別適合具有多個 AWS 賬戶的大型組織</li>
                <li>合規要求 - 幫助滿足需要一致安全控制的監管要求</li>
                <li>安全標準化 - 確保所有團隊遵循相同的安全標準</li>
                <li>實施步驟：
                    <ol>
                        <li>設置 AWS Organizations 並啟用所有功能</li>
                        <li>指定 Firewall Manager 管理員賬戶</li>
                        <li>創建安全策略並定義範圍（賬戶、資源類型等）</li>
                        <li>配置修復操作（自動或手動）</li>
                        <li>監控合規性並根據需要調整策略</li>
                    </ol>
                </li>
            </ul>
        </li>
    </ul>
    
    <h3>Amazon GuardDuty</h3>
    <ul>
        <li>威脅檢測服務，持續監控惡意活動
            <ul>
                <li>使用機器學習、異常檢測和威脅情報
                    <ul>
                        <li>機器學習模型 - 建立賬戶活動的基準並檢測異常</li>
                        <li>威脅情報源 - 利用 AWS 內部和第三方威脅情報</li>
                        <li>行為分析 - 識別可疑的訪問模式和活動</li>
                        <li>持續更新 - AWS 不斷更新檢測能力以應對新威脅</li>
                    </ul>
                </li>
                <li>無需部署額外的安全軟件或基礎設施
                    <ul>
                        <li>完全托管服務 - 無需安裝或維護代理</li>
                        <li>零性能影響 - 不影響工作負載性能</li>
                        <li>快速啟用 - 只需幾次點擊即可啟用</li>
                        <li>自動擴展 - 隨著環境增長自動擴展</li>
                    </ul>
                </li>
                <li>持續監控和分析
                    <ul>
                        <li>實時檢測 - 持續分析日誌和事件</li>
                        <li>全天候監控 - 24/7 不間斷監控</li>
                        <li>多賬戶視圖 - 可以集中監控多個 AWS 賬戶</li>
                        <li>歷史分析 - 可以回溯分析過去的活動</li>
                    </ul>
                </li>
                <li>威脅檢測範圍
                    <ul>
                        <li>憑證洩露 - 檢測可能的 AWS 憑證洩露</li>
                        <li>惡意軟件 - 識別可能的惡意軟件活動</li>
                        <li>後門活動 - 檢測未經授權的遠程訪問</li>
                        <li>加密貨幣挖礦 - 識別計算資源的濫用</li>
                        <li>橫向移動 - 檢測攻擊者在環境中的擴散</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>分析 VPC 流日誌、CloudTrail 和 DNS 日誌
            <ul>
                <li>檢測未經授權的訪問
                    <ul>
                        <li>異常 IP 地址 - 識別來自已知惡意 IP 地址的連接</li>
                        <li>異常訪問模式 - 檢測不尋常的訪問時間或頻率</li>
                        <li>端口掃描檢測 - 識別針對多個端口的探測</li>
                        <li>異常地理位置 - 檢測來自異常地理位置的訪問</li>
                    </ul>
                </li>
                <li>識別可疑的 API 調用
                    <ul>
                        <li>權限提升嘗試 - 檢測嘗試獲取更高權限的操作</li>
                        <li>異常 API 使用 - 識別不符合正常模式的 API 調用</li>
                        <li>憑證洩露指標 - 檢測可能表明憑證被盜用的活動</li>
                        <li>配置更改 - 識別可疑的安全配置更改</li>
                    </ul>
                </li>
                <li>發現惡意域名和 IP 地址
                    <ul>
                        <li>DNS 數據泄露 - 檢測通過 DNS 的數據外洩嘗試</li>
                        <li>命令與控制通信 - 識別與已知惡意域名的通信</li>
                        <li>加密貨幣挖礦池連接 - 檢測與挖礦池的通信</li>
                        <li>異常 DNS 模式 - 識別可疑的 DNS 查詢模式</li>
                    </ul>
                </li>
                <li>其他數據源
                    <ul>
                        <li>S3 數據事件 - 監控 S3 存儲桶訪問</li>
                        <li>Kubernetes 審計日誌 - 監控 EKS 集群中的活動</li>
                        <li>RDS 登錄活動 - 監控數據庫訪問嘗試</li>
                        <li>Lambda 網絡活動 - 監控 Lambda 函數的網絡通信</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>使用機器學習識別異常行為
            <ul>
                <li>檢測加密貨幣挖礦
                    <ul>
                        <li>資源利用率分析 - 檢測異常的 CPU 使用模式</li>
                        <li>挖礦池通信 - 識別與已知挖礦池的連接</li>
                        <li>異常出站流量 - 檢測與挖礦相關的網絡模式</li>
                        <li>基於行為的檢測 - 識別典型的挖礦行為特徵</li>
                    </ul>
                </li>
                <li>識別憑證洩露
                    <ul>
                        <li>異常登錄位置 - 檢測來自新地理位置的訪問</li>
                        <li>異常訪問時間 - 識別在非典型時間的活動</li>
                        <li>異常資源訪問 - 檢測訪問通常不使用的資源</li>
                        <li>憑證導出 - 識別可能的憑證導出操作</li>
                    </ul>
                </li>
                <li>發現異常 API 調用模式
                    <ul>
                        <li>基準偏差 - 比較當前活動與歷史基準</li>
                        <li>異常操作序列 - 識別不尋常的 API 調用序列</li>
                        <li>權限探測 - 檢測嘗試確定權限邊界的活動</li>
                        <li>異常頻率 - 識別異常高頻率的 API 調用</li>
                    </ul>
                </li>
                <li>其他異常檢測
                    <ul>
                        <li>數據外洩嘗試 - 識別可能的數據泄露活動</li>
                        <li>橫向移動 - 檢測攻擊者在環境中的擴散</li>
                        <li>持久性機制 - 識別攻擊者嘗試建立持久訪問的行為</li>
                        <li>防禦規避 - 檢測嘗試繞過安全控制的活動</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>與 EventBridge 集成實現自動響應
            <ul>
                <li>自動修復受損資源
                    <ul>
                        <li>隔離受影響的實例 - 自動修改安全組限制訪問</li>
                        <li>輪換憑證 - 自動輪換可能被洩露的憑證</li>
                        <li>終止可疑資源 - 自動終止可能被入侵的實例</li>
                        <li>快照取證 - 在終止前自動創建磁盤快照用於調查</li>
                    </ul>
                </li>
                <li>通知安全團隊
                    <ul>
                        <li>多種通知渠道 - 通過 SNS、Slack、電子郵件等發送警報</li>
                        <li>嚴重性分級 - 根據威脅嚴重性調整通知方式</li>
                        <li>詳細上下文 - 提供足夠信息以便快速響應</li>
                        <li>聚合警報 - 減少警報疲勞，聚合相關發現</li>
                    </ul>
                </li>
                <li>觸發自定義響應工作流
                    <ul>
                        <li>與 Security Hub 集成 - 集中管理安全發現</li>
                        <li>與 Step Functions 集成 - 編排複雜的響應工作流</li>
                        <li>與 Lambda 集成 - 執行自定義響應邏輯</li>
                        <li>與 SIEM 系統集成 - 將發現導出到外部安全工具</li>
                    </ul>
                </li>
                <li>自動化最佳實踐
                    <ul>
                        <li>分層響應 - 根據威脅嚴重性採取不同響應</li>
                        <li>人工審核 - 對高影響操作保留人工審核步驟</li>
                        <li>響應文檔 - 記錄所有自動響應操作</li>
                        <li>定期測試 - 測試自動響應工作流的有效性</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>部署和管理
            <ul>
                <li>多賬戶部署 - 通過 AWS Organizations 在多個賬戶中集中管理</li>
                <li>自定義發現結果 - 調整嚴重性級別和抑制特定發現</li>
                <li>成本優化 - 選擇性啟用特定數據源以控制成本</li>
                <li>實施步驟：
                    <ol>
                        <li>啟用 GuardDuty（30 天免費試用）</li>
                        <li>配置數據源和保留設置</li>
                        <li>設置 EventBridge 規則進行自動響應</li>
                        <li>與 Security Hub 集成以集中管理發現</li>
                        <li>定期審查發現並調整配置</li>
                    </ol>
                </li>
            </ul>
        </li>
    </ul>
    
    <h3>AWS Config</h3>
    <ul>
        <li>評估、審計和評價資源配置
            <ul>
                <li>持續監控和記錄 AWS 資源配置
                    <ul>
                        <li>配置項目 - 記錄 AWS 資源的詳細配置快照</li>
                        <li>配置歷史 - 跟踪資源配置隨時間的變化</li>
                        <li>變更通知 - 當資源配置發生變化時發送通知</li>
                        <li>廣泛覆蓋 - 支持大多數 AWS 資源類型</li>
                    </ul>
                </li>
                <li>評估資源配置是否符合最佳實踐
                    <ul>
                        <li>合規性檢查 - 根據預定義規則評估資源配置</li>
                        <li>持續評估 - 在資源創建和配置更改時自動評估</li>
                        <li>合規性儀表板 - 提供資源合規性的視覺化視圖</li>
                        <li>詳細報告 - 識別不合規資源及原因</li>
                    </ul>
                </li>
                <li>追踪資源關係和配置歷史
                    <ul>
                        <li>資源關係 - 可視化資源之間的依賴關係</li>
                        <li>配置時間線 - 查看資源配置的完整歷史</li>
                        <li>變更比較 - 比較不同時間點的配置差異</li>
                        <li>資源映射 - 提供資源關係的圖形視圖</li>
                    </ul>
                </li>
                <li>安全和合規用例
                    <ul>
                        <li>安全態勢評估 - 識別安全配置錯誤</li>
                        <li>合規性證明 - 提供合規性審計的證據</li>
                        <li>變更管理 - 跟踪和驗證配置更改</li>
                        <li>問題排查 - 使用配置歷史識別問題根源</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>記錄配置更改並提供合規性檢查
            <ul>
                <li>創建配置快照
                    <ul>
                        <li>詳細配置記錄 - 捕獲資源的完整配置詳情</li>
                        <li>按需快照 - 可以隨時創建當前配置的快照</li>
                        <li>定期快照 - 自動按計劃創建配置快照</li>
                        <li>存儲選項 - 可以將快照存儲在 S3 中長期保留</li>
                    </ul>
                </li>
                <li>查看資源配置時間線
                    <ul>
                        <li>完整歷史 - 查看資源從創建到刪除的完整配置歷史</li>
                        <li>變更詳情 - 了解每次配置更改的具體內容</li>
                        <li>關聯事件 - 將配置更改與 CloudTrail 事件關聯</li>
                        <li>時間點查看 - 查看特定時間點的資源配置狀態</li>
                    </ul>
                </li>
                <li>評估資源是否符合規則
                    <ul>
                        <li>規則類型 - 支持 AWS 托管規則和自定義規則</li>
                        <li>評估觸發器 - 配置更改時或定期評估</li>
                        <li>合規性狀態 - 標記資源為合規或不合規</li>
                        <li>詳細結果 - 提供不合規原因的詳細說明</li>
                    </ul>
                </li>
                <li>合規性報告
                    <ul>
                        <li>聚合視圖 - 跨賬戶和區域的合規性狀態</li>
                        <li>趨勢分析 - 跟踪合規性狀態隨時間的變化</li>
                        <li>導出功能 - 將合規性報告導出為 CSV 或 JSON</li>
                        <li>與 Security Hub 集成 - 提供更全面的安全視圖</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>多賬戶、多區域數據聚合
            <ul>
                <li>集中查看合規狀態
                    <ul>
                        <li>聚合器 - 創建配置和合規數據的中央視圖</li>
                        <li>單一控制台 - 從一個位置查看所有賬戶和區域的數據</li>
                        <li>全面視圖 - 了解整個組織的合規態勢</li>
                        <li>篩選和搜索 - 根據賬戶、區域、資源類型等篩選數據</li>
                    </ul>
                </li>
                <li>跨賬戶和區域應用規則
                    <ul>
                        <li>一致的合規標準 - 在所有賬戶和區域應用相同的規則</li>
                        <li>集中管理 - 從一個位置管理所有規則</li>
                        <li>委派管理 - 指定 Config 管理員賬戶</li>
                        <li>與 Organizations 集成 - 自動包含新賬戶</li>
                    </ul>
                </li>
                <li>合規報告和分析
                    <ul>
                        <li>合規儀表板 - 視覺化合規狀態</li>
                        <li>詳細報告 - 深入了解特定資源或規則</li>
                        <li>趨勢分析 - 跟踪合規性隨時間的變化</li>
                        <li>導出功能 - 將數據導出用於進一步分析或報告</li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
    
    <div class="note">
        <p>考試要點：了解 AWS Config 如何與其他安全服務（如 Security Hub、CloudTrail）協同工作，提供全面的安全態勢管理。</p>
        <p>服務集成：</p>
        <ul>
            <li>與 CloudTrail 集成 - 將配置更改與 API 調用關聯，了解誰進行了更改</li>
            <li>與 Security Hub 集成 - 將 Config 發現結果發送到 Security Hub 進行集中安全管理</li>
            <li>與 Systems Manager 集成 - 使用 SSM 自動化文檔修復不合規資源</li>
            <li>與 EventBridge 集成 - 基於配置更改或合規性狀態變化觸發自動化工作流</li>
            <li>與 Organizations 集成 - 跨整個組織管理 Config 規則和聚合器</li>
        </ul>
        <p>使用場景：</p>
        <ul>
            <li>合規性審計 - 提供資源配置的歷史記錄，用於合規性審計</li>
            <li>安全分析 - 識別安全配置錯誤和漏洞</li>
            <li>變更管理 - 跟踪和驗證配置更改</li>
            <li>問題排查 - 使用配置時間線識別問題根源</li>
            <li>資源管理 - 了解資源關係和依賴關係</li>
        </ul>
    </div>

    <div class="nav">
        <a href="01-網絡架構.html">上一章：網絡架構</a>
        <a href="03-計算服務.html">下一章：計算服務</a>
    </div>
</body>
</html>
